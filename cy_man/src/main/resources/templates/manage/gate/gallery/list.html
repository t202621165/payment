<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>list.html</title>

<meta name="keywords" content="keyword1,keyword2,keyword3">
<meta name="description" content="this is my page">
<meta name="content-type" content="text/html; charset=UTF-8">
<link href="/assets/css/css.css" rel="stylesheet" type="text/css">
<link href="/assets/css/main.css" rel="stylesheet" type="text/css">
<style>
body {
	overflow-x: auto;
	background: #f2f0f5;
	padding: 15px 0px 10px 5px;
}
</style>
</head>
<div th:replace="manage/common/common_js :: basic"></div>
<body>
	<!--main_top-->
	<table th:width="99+'%'" th:border="0" th:cellspacing="0"
		th:cellpadding="0" id="searchmain" :controller="gallery">
		<tr>
			<td th:width="99+'%'" th:align="left" th:valign="top">您的位置：<span
				th:text="通道列表"></span>
			</td>
		</tr>
		<tr>
			<td th:align="left" th:valign="top">
				<form id="form">
					<div th:class="searchDiv" th:align="left">
						<div th:class="search-input">
							<div th:class="search-input-top">
								<span id="paging">每页数量：</span>
								<div th:replace="manage/common/common_js :: pageSize"></div>
							</div>
						</div>						

						<div th:class="search-input">
							<div th:class="search-input-top">
								<div>
									<input id="add" type="button" value="添加" class="btn-check btn-default btn-query">
								</div>
							</div>
						</div>
					</div>
				</form>
			</td>
		</tr>
		<tr>
			<td th:align="left" th:valign="top">

				<table th:width="100+'%'" th:border="0" th:cellspacing="0" th:cellpadding="0" id="main-tab">
					<thead id="tableTitle">
						<tr>
					        <th th:style="@{background: url('/assets/images/main/list_bg2.jpg') repeat-x;}" rowspan="2" th:align="center" th:valign="middle" th:class="borderright">编号</th>
					        <th th:style="@{background: url('/assets/images/main/list_bg2.jpg') repeat-x;}" rowspan="2" th:align="center" th:valign="middle" th:class="borderright">通道名称</th>
					        <th colspan="7" th:align="center" th:valign="middle" th:class="borderright">支持业务</th>
					        <th th:style="@{background: url('/assets/images/main/list_bg2.jpg') repeat-x;}" th:rowspan="2" th:align="center" th:valign="middle" th:class="borderright">状态</th>
						    <th th:style="@{background: url('/assets/images/main/list_bg2.jpg') repeat-x;}" th:rowspan="2" th:align="center" th:valign="middle" class="btn-group4">操作</th>
					   </tr>
					   <tr>
					        <th th:align="center" th:valign="middle" th:class="borderright">支付宝</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">微信</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">网银</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">财付通</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">QQ钱包</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">蚂蚁花呗</th>
					        <th th:align="center" th:valign="middle" th:class="borderright">银联扫码</th>
					   </tr>
					</thead>
					<tbody id="dataBody">
						<tr th:onMouseOut="@{this.style.backgroundColor='#ffffff'}"
							th:onMouseOver="@{this.style.backgroundColor='#edf5ff'}" :for="($index,item) in @data.content">
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<span :text="$index+1"></span>
								<input type="hidden" id="id" :duplex="@item.id"/>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}" :text="@item.name"></td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.alipay" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.alipay">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.wechat" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.wechat">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.ebank" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.ebank">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.tenpay" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.tenpay">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.qpay" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.qpay">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.hbpay" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.hbpay">--</span>
							</td>
							<td th:align="center" th:valign="middle"
								th:class="@{borderright borderbottom}">
								<img :if="@item.support.union" th:src='@{/assets/images/main/suppor.png}'/>
								<span :if="!@item.support.union">--</span>
							</td>
							<td th:align="center" th:valign="middle" class="borderright borderbottom">
								<label :attr="{for:'switch-'+$index}" class="label-box no-margin">
									<input :attr="{id:'switch-'+$index}" type="checkbox" :duplex-checked="@item.state" :click="@render.enable(item)"/>
									<span class="box-switch swith-blue enable dis"><i></i></span>
								</label>
							</td>
								
							<td th:align="center" th:valign="middle" class="borderright borderbottom">
								<div class="btn-group">
									<input type="button" value="编辑" :click="@render.edit(item)" class="btn-check btn-default"> 
									<input type="button" value="通道费率" :click="@render.galleryRate(item)" class="btn-check btn-blue">
									<input type="button" value="删除" :click="@render.del(item.id)" class="btn-check btn-red">
								</div>
							</td>								
						</tr>
					</tbody>
				</table>
			</td>
		</tr>
		<tr>
			<td th:align="left" th:valign="top" th:class="fenye"
				th:style="@{text-align: left;}">
				<div th:replace="manage/common/common_js :: fenye"></div>
			</td>
		</tr>
	</table>
	<div id="gallerys" style="display: none;">
		<table th:width="100+'%'" id="main-tab">
			<tbody id="selects" class="active-tb baseInfo">
				<tr th:each="item,itemState:${gallerys}">
					<td th:align="center" th:valign="middle" class="borderright borderbottom" th:each="gallery,gState:${item}">
						<label th:for="${'isContains'+(4*itemState.index+gState.index)}" class="label-box checkbox checkbox-min box-blue">
							<input type="checkbox" th:id="${'isContains'+(4*itemState.index+gState.index)}" name="mark" th:value="${gallery.mark}">
							<span class="box-left" th:text="${gallery.name}"></span>
							<i class="check-right check"></i>
						</label>
					</td>
				</tr>
			</tbody>
			<tfoot>
				<tr style="background-color: #edf5ff;">
					<td th:colspan="4" class="main-for" style="text-align: center;">
						<input id="add-gallery" type="button" value="添加" class="btn-check btn-blue">
					</td>
				</tr>
			</tfoot>
		</table>
		<script type="text/javascript">
			$("#add-gallery").on("click", function() {
				var gallerys = $("#selects input").serializeArray();
				if (gallerys == "") {
					error("请选择需要添加的通道！",1000);
					return;
				}
				ajaxSend("post", "/man/gallery/save", gallerys, function(data) {
					success(data.msg, 3500);
					window.parent.layer.close(mainFrame.lay_gallery);
					mainFrame.paging && mainFrame.paging.query();
				});
			});
		</script>
	</div>
	<script>
		var reg = new RegExp("%5B","g");
		var options = {
			enable : function(e) {
				window.parent.ajaxSend("post", "/man/gallery/state", {
					_method:"PUT",
					id : e.id
				}, function(data) {
					result(data);
				});
			},
			edit:function(e){
				window.parent.gallery(e);
			},
			del:function(e){
				window.parent.del("/man/gallery/del",e,"是否确实删除该通道?");
			},
			galleryRate:function(e){
				window.parent.galleryRate(e);
			}
		}	
		var paging = $.paging("gallery", options, "#form");
		function result(data) {
			if (data.state) {
				paging.query();
				window.parent.success(data.msg,1000);
			} else {
				window.parent.error(data.msg,1000);
			}
		}
		var lay_gallery;
		$("#add").on("click", function() {
			lay_gallery = parent.layer.open({
				type : 1,
				skin : 'layui-layer-lan',
				title : "添加通道",
				area : ['550px'],
				id : 'layui_gallerys',
				fixed : false,
				maxmin : true,
				content : $("#gallerys").html()
			});
		});
	</script>
</body>
</html>
